# 📔 감정 영상 일기 - Emotion Video Diary

실시간 감정 분석과 음성 인식 기능이 포함된 영상 일기 애플리케이션입니다.

## ✨ 주요 기능

### 1. 🎥 실시간 영상 녹화
- 웹캠을 통한 실시간 영상 녹화
- 감정 분석 결과 오버레이
- MP4 형식으로 저장

### 2. 🎭 감정 분석
- AI 기반 실시간 얼굴 감정 분석
- 7가지 감정 인식 (행복, 슬픔, 화남, 놀람, 중립, 두려움, 혐오)
- 감정 변화 타임라인 시각화

### 3. 🎤 음성 인식 (NEW!)
- 한국어 음성을 실시간으로 텍스트로 변환
- 녹화 중 말한 내용 자동 저장
- 텍스트 파일로 다운로드 가능

### 4. 🔒 얼굴 익명화 (개선!)
- **원본**: 얼굴 그대로 표시
- **블러**: 얼굴을 흐리게 처리
- **픽셀화**: 모자이크 효과 적용
- **카툰**: 만화 스타일로 변환
- ✅ **실시간 미리보기**: 선택한 익명화 방식이 웹캠 화면에 바로 적용됩니다

### 5. 📊 감정 분석 통계
- 감정 분포 파이 차트
- 프레임별 감정 변화 그래프
- 감정 타임라인 테이블

## 🚀 설치 방법

### 1. 필수 패키지 설치

```bash
pip install -r requirements.txt
```

### 2. PyAudio 설치 (음성 인식용)

**Windows:**
```bash
pip install pyaudio
```

**macOS:**
```bash
brew install portaudio
pip install pyaudio
```

**Linux (Ubuntu/Debian):**
```bash
sudo apt-get install portaudio19-dev python3-pyaudio
pip install pyaudio
```

### 3. 실행

```bash
streamlit run emotion_diary_enhanced.py
```

## 📖 사용 방법

### 기본 사용 순서

1. **익명화 방식 선택**
   - 드롭다운에서 원하는 익명화 방식 선택
   - 웹캠 화면에서 실시간으로 확인 가능

2. **음성 입력 사용 선택** (선택사항)
   - "🎤 음성 입력 사용" 체크박스 클릭
   - 마이크 권한 허용

3. **녹화 시작**
   - "🔴 녹화 시작" 버튼 클릭
   - 웹캠이 자동으로 활성화

4. **감정 표현하며 이야기**
   - 자연스럽게 감정을 표현
   - 음성 입력 사용 시 말한 내용이 자동으로 텍스트로 변환

5. **녹화 중지 & 저장**
   - "⏹️ 녹화 중지 & 저장" 버튼 클릭
   - 영상과 텍스트가 자동으로 저장

6. **다운로드**
   - 📥 영상 일기 다운로드 (MP4)
   - 📄 일기 텍스트 다운로드 (TXT)

### 💡 촬영 팁

#### 영상 촬영
- 💡 **조명**: 밝은 조명 사용 (얼굴이 잘 보이도록)
- 📷 **각도**: 정면을 바라보기 (측면은 인식률 낮음)
- 😀 **표정**: 자연스러운 표정 유지
- 🎨 **배경**: 단순한 배경이 좋음

#### 음성 입력
- 🔇 **환경**: 조용한 환경에서 녹음
- 🎤 **거리**: 마이크 가까이에서 말하기
- 🗣️ **발음**: 또박또박 명확하게 발음
- ⏱️ **속도**: 너무 빠르지 않게 말하기

## 🛠️ 기술 스택

- **Python 3.12**: 프로그래밍 언어
- **Streamlit**: 웹 인터페이스
- **OpenCV**: 영상 처리
- **MediaPipe**: 얼굴 검출
- **Hugging Face Transformers**: 감정 분석 AI 모델
- **SpeechRecognition**: 음성 인식
- **Plotly**: 데이터 시각화

## 🎭 지원 감정

| 감정 | 이모지 | 영어 |
|------|--------|------|
| 행복 | 😊 | Happy |
| 슬픔 | 😢 | Sad |
| 화남 | 😠 | Angry |
| 놀람 | 😲 | Surprise |
| 중립 | 😐 | Neutral |
| 두려움 | 😨 | Fear |
| 혐오 | 🤢 | Disgust |

## 🔒 익명화 방식 비교

### 원본
- 얼굴이 그대로 표시됩니다
- 감정 분석 정확도가 가장 높습니다

### 블러
- 가우시안 블러로 얼굴을 흐리게 처리
- 적당한 익명화 수준
- 감정 분석에 영향 없음

### 픽셀화
- 모자이크 효과로 얼굴을 블록 단위로 처리
- 강력한 익명화
- 감정 분석에 영향 없음

### 카툰 (개선됨!)
- 만화 스타일로 변환
- bilateral filter로 색상 단순화
- adaptive threshold로 윤곽선 검출
- 가장 창의적인 익명화 방식
- 실시간 미리보기로 효과 확인 가능

## 📁 파일 저장 형식

### 영상 파일 (MP4)
- 파일명: `emotion_diary_YYYYMMDD_HHMMSS.mp4`
- 코덱: MP4V
- FPS: 20
- 해상도: 640x480

### 텍스트 파일 (TXT)
- 파일명: `emotion_diary_YYYYMMDD_HHMMSS.txt`
- 인코딩: UTF-8
- 내용:
  - 날짜 및 시간
  - 익명화 방식
  - 일기 내용
  - 감정 분석 결과
  - 감정 분포 통계

## ⚠️ 주의사항

### 시스템 요구사항
- 웹캠 필수
- 마이크 필수 (음성 입력 사용 시)
- Python 3.8 이상
- 최소 4GB RAM 권장
- 인터넷 연결 (AI 모델 다운로드 시)

### 개인정보 보호
- 모든 영상과 텍스트는 로컬에만 저장됩니다
- 외부 서버로 전송되지 않습니다
- 익명화 기능을 사용하여 프라이버시 보호 가능

### 음성 인식
- 인터넷 연결 필요 (Google Speech Recognition API 사용)
- 조용한 환경에서 사용 권장
- 한국어만 지원

## 🐛 문제 해결

### 웹캠이 열리지 않을 때
```python
# OpenCV 웹캠 인덱스 확인
import cv2
cap = cv2.VideoCapture(0)  # 0, 1, 2 등 다른 숫자 시도
```

### 음성 인식이 안 될 때
1. 마이크 권한 확인
2. 마이크가 제대로 연결되어 있는지 확인
3. 인터넷 연결 확인
4. 조용한 환경인지 확인

### AI 모델 로드 오류
- 인터넷 연결 확인
- 충분한 저장 공간 확인
- 페이지 새로고침

### 카툰 효과가 제대로 안 보일 때
- 조명이 충분한지 확인
- 얼굴이 정면을 향하는지 확인
- 웹캠 화면에서 실시간으로 미리보기 확인

## 📝 변경사항

### v2.0 (현재 버전)
- ✅ 음성 인식 기능 추가
- ✅ 텍스트 다운로드 기능 추가
- ✅ 익명화 실시간 미리보기 기능 추가
- ✅ 카툰 효과 개선
- ✅ UI/UX 개선

### v1.0
- 기본 영상 녹화 기능
- 감정 분석 기능
- 익명화 기능
- 감정 통계 시각화

## 📧 문의 및 피드백

문제가 발생하거나 개선 사항이 있으면 이슈를 등록해주세요.

---

**만든이**: Claude AI  
**라이선스**: MIT  
**마지막 업데이트**: 2024년 12월